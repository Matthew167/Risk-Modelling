
#------------------------------------------------------------------------------------
# i)
#------------------------------------------------------------------------------------

# a)
# head(iris)

set.seed(19)
training.rows <- sample(1:nrow(iris), 0.6 * nrow(iris))
iris.train <- iris[training.rows, ]

# b)
head(iris.train, 10)

#------------------------------------------------------------------------------------
# ii)
#------------------------------------------------------------------------------------

# a)
# install.packages("tree")
library(tree)

iris_tree <- tree(Species ~ ., data = iris.train)

# b)
iris_tree

#------------------------------------------------------------------------------------
# iii)
#------------------------------------------------------------------------------------

plot(iris_tree)
text(iris_tree, pos = 1, offset = 0.8, cex = 0.9)

#------------------------------------------------------------------------------------
# iv)
#------------------------------------------------------------------------------------

newdata <- data.frame(Petal.Length = 2.5,
                      Petal.Width = 0.3,
                      Sepal.Length = 5,
                      Sepal.Width = 3.7)

predict(iris_tree, newdata, type = "class")

# predict(iris_tree, newdata)

#------------------------------------------------------------------------------------
# v)
#------------------------------------------------------------------------------------

# a)
iris.test <- iris[-training.rows, ]

test_preds <- predict(iris_tree, newdata = iris.test, type = "class")

# b)
table(iris.test$Species, test_preds)

#------------------------------------------------------------------------------------
# vi)
#------------------------------------------------------------------------------------

#install.packages("randomForest")
library(randomForest)

set.seed(7233)
iris_forest <- randomForest(Species ~ ., data = iris.train, mtry = 2, ntree = 1000)

#------------------------------------------------------------------------------------
# vii)
#------------------------------------------------------------------------------------

predict(iris_forest, newdata, type = "class")

#------------------------------------------------------------------------------------
# viii)
#------------------------------------------------------------------------------------

# a)
test_preds_rf <- predict(iris_forest, newdata = iris.test, type = "class")

# b)
table(iris.test$Species, test_preds_rf)

#------------------------------------------------------------------------------------
# ix)
#------------------------------------------------------------------------------------

sum(diag(table(iris.test$Species, test_preds))) / nrow(iris.test)
sum(diag(table(iris.test$Species, test_preds_rf))) / nrow(iris.test)